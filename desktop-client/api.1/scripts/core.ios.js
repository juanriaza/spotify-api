SpotifyApi.prototype._init=function(){this._bi=Math.floor(1E10*Math.random());this._id=1;this._sr={};this._cc=0;this._connect();this.request("bridge_create",[]);var a=this;window.addEventListener("unload",function(){a.request("bridge_destroy",[]);delete a._ws})};
SpotifyApi.prototype._connect=function(){this._ct=null;this._cc++;var a=this,b=window.location.href.match(/^sp:\/\/([^@]+)/)[1];this._ws=new WebSocket("ws://localhost:5563/"+b);this._ws.onmessage=function(b){a._requestReply(b.data)};this._ws.onclose=function(){a._disconnected()};this._ws.onopen=function(){a._connected()};2<=this._ws.readyState&&this._disconnected()};
SpotifyApi.prototype._connected=function(){this._cc=0;Object.keys(this._sr).sort(function(a,b){return a-b}).forEach(function(a){this._ws.send(this._sr[a].m)},this)};SpotifyApi.prototype._disconnected=function(){if(!this._ct){this._ws&&(delete this._ws.onopen,delete this._ws.onmessage,delete this._ws.onclose,delete this._ws.onerror,delete this._ws);var a=this,b=Math.round(1E3*Math.log(this._cc));this._ct=setTimeout(function(){a._connect()},b)}};
SpotifyApi.prototype.request=function(a,b,c,e,f){var d=this._id++,a=JSON.stringify({id:d,name:a,args:b,bridge:this._bi});this._sr[d]={c:c,s:e,f:f,m:a};this._ws&&1===this._ws.readyState&&this._ws.send(a);this._prepareFlush()};SpotifyApi.prototype._requestReply=function(a){var a=JSON.parse(a),b=a._fail,c=this._sr[a._id];c&&(delete this._sr[a._id],delete a._fail,delete a._id,(b=b?c.f:c.s)&&b.call(c.c,a))};
SpotifyApi.prototype._overrideLog=function(a){var b=this,c=console[a];console[a]=function(){c.apply(console,arguments);if(!b._noLog)try{b._noLog=!0,b.request("console_"+a,[].slice.call(arguments))}finally{b._noLog=!1}}};SpotifyApi.api=new SpotifyApi;SpotifyApi.api._init();SpotifyApi.api._overrideLog("debug");SpotifyApi.api._overrideLog("dir");SpotifyApi.api._overrideLog("log");SpotifyApi.api._overrideLog("info");SpotifyApi.api._overrideLog("warn");SpotifyApi.api._overrideLog("error");
window.onerror=function(a,b,c){console.error(a,b,c)};
