function SpotifyApi(){this._modules={};this._requested={};this._moduleQueue=[];this._delayedFns=[];this._parallelReqs=4;this._contextStack=[];this._deferredFlush=!1;this._patchRequestOpen()}SpotifyApi.AnalyticsContext=function(a){this.name=a;this.id=SpotifyApi.AnalyticsContext._nextId++;this.references=0;this._begin()};SpotifyApi.AnalyticsContext._nextId=1;SpotifyApi.AnalyticsContext.prototype.addReference=function(){this.references++};
SpotifyApi.AnalyticsContext.prototype.removeReference=function(){this.references--;0===this.references&&this._end()};SpotifyApi.AnalyticsContext.prototype._begin=function(){SpotifyApi.api.request("core_context_begin",[this.id,this.name],this)};SpotifyApi.AnalyticsContext.prototype._end=function(){SpotifyApi.api.request("core_context_end",[this.id],this)};
SpotifyApi.prototype.analyticsContext=function(a,b){var c=new SpotifyApi.AnalyticsContext(a);c.addReference();this._contextStack.push(c);try{b()}finally{this._contextStack.pop(),c.removeReference()}};SpotifyApi.Callback=function(a,b){this._func=a;this._setContextStack(b||SpotifyApi.api._contextStack)};
SpotifyApi.Callback.prototype.apply=function(a,b){try{var c=SpotifyApi.api._contextStack;SpotifyApi.api._contextStack=this._contextStack;this._func.apply(a,b)}catch(d){setTimeout(function(){throw d;},0)}finally{SpotifyApi.api._contextStack=c,this.clear()}};SpotifyApi.Callback.prototype.call=function(a,b){this.apply(a,Array.prototype.slice.call(arguments,1))};SpotifyApi.Callback.prototype.copy=function(){return new this.constructor(this._func,this._contextStack)};
SpotifyApi.Callback.prototype.clear=function(){this._releaseContextStack();delete this._func;delete this._contextStack};SpotifyApi.Callback.prototype._setContextStack=function(a){for(var b=0,c=a.length;b<c;++b)a[b].addReference();this._contextStack=a.slice(0)};SpotifyApi.Callback.prototype._releaseContextStack=function(){for(var a=this._contextStack,b=0,c=a.length;b<c;++b)a[c-b-1].removeReference()};SpotifyApi.prototype.callback=function(a){return new SpotifyApi.Callback(a)};
SpotifyApi.prototype._getContextIdForRequest=function(){var a=this._contextStack;return a.length?a[a.length-1].id:0};window.addEventListener("message",function(a){if(a.source==window&&"api-delay"==a.data){a.stopPropagation();for(var a=SpotifyApi.api._delayedFns.splice(0),b=0,c=a.length;b<c;b++)a[b].call()}});SpotifyApi.prototype._prepareFlush=function(){this._deferredFlush||(this._deferredFlush=!0,this.defer(this,this._flushRequests))};
SpotifyApi.prototype._flushRequests=function(){this.request("core_flush",[]);this._deferredFlush=!1};SpotifyApi.prototype.defer=function(a,b){1==this._delayedFns.push(this.bind(this.callback(b),a))&&window.postMessage("api-delay","*")};SpotifyApi.prototype._evalModule=function(a,b,c,d){return!/\.lang$/.test(c)?this._evalJSModule(a,b,c,d):this._evalLangModule(c,d)};
SpotifyApi.prototype._evalJSModule=function(a,b,c,d){var e=this,f={__name:c},g=function(d,h){f.__waiting=!0;var g=function(){f.__waiting=!1;return h.apply(this,arguments)};g.__native=!0;return e._require(c,a,b,d,g)};try{return(new Function("require","exports","SP","_code","eval(_code)")).call({},g,f,this,"'use strict';"+d+"\n//@ sourceURL="+c),f}catch(h){throw h.message+=" in "+c,h;}};SpotifyApi.LangModule=function(a,b){this.__name=a;this.strings=b};
SpotifyApi.LangModule.prototype.get=function(a,b){for(var c=this.strings.hasOwnProperty(a)?this.strings[a]:a,d="",e=0,f,g;-1<(f=c.indexOf("{",e));){g=c.indexOf("}",f+1);if(-1==g)break;var h=arguments[parseInt(c.substring(f+1,g))+1],d=void 0!==h?d+(c.substring(e,f)+h):d+c.substring(e,g+1),e=g+1}return e?d+c.substring(e):c};
SpotifyApi.prototype._evalLangModule=function(a,b){try{return new SpotifyApi.LangModule(a,JSON.parse(b))}catch(c){throw Error('Cannot import language file "'+a+'": '+c.message);}};SpotifyApi.prototype._fireCallbacks=function(a){for(;a;){a.waiting--;if(a.waiting)break;a.unpacked.forEach(function(b){var c=b.position,d=a.args[c],b=b.property;if(!(b in d))throw Error('No "'+b+'" exported in module "'+d.__name+'"');a.args[c]=d[b]});a.callback.apply({},a.args);a.waiting=1/0;a=a.parent}};
SpotifyApi.prototype._createRequest=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0);c.onreadystatechange=function(){if(4==c.readyState){if(200!=c.status&&0!=c.status)throw Error('Could not load module "'+a+'"; Not found.');b(c.responseText)}};c.send(null)};
SpotifyApi.prototype._loadModule=function(a,b,c,d,e){var f=this,g=this._modules[c];g&&!g.__waiting?(a.args[d]=this._modules[c],e&&a.unpacked.push({property:e,position:d}),this._fireCallbacks(a)):this._requested[c]||!this._parallelReqs?this.defer(this,function(){this._loadModule(a,b,c,d,e)}):(this._requested[c]=!0,this._parallelReqs--,this._createRequest(c,function(g){f._parallelReqs++;g=f._modules[c]=f._evalModule(a,b,c,g);a.args[d]=g;e&&a.unpacked.push({property:e,position:d});f._fireCallbacks(a)}))};
SpotifyApi.prototype._resolveModule=function(a){if(!/\.lang$/.test(a)){var b=a.match(/^(\$(?:[^\/]+)\/)(?!scripts)(.*)/);b&&(a=b[1]+"scripts/"+b[2]);a+=".js"}return a};
SpotifyApi.prototype._require=function(a,b,c,d,e){"string"==typeof d&&(d=[d]);if(!d||!d.length)throw Error("Missing modules argument to require().");if(!e||"function"!=typeof e)throw Error("Missing callback function argument to require().");var f=d.length;if(!e.__native&&f!=e.length)throw Error("Module-parameter mismatch! Imported "+f+" but only declared "+e.length+" in callback.");a={name:a,parent:b,waiting:f,callback:e,args:Array(f),unpacked:[]};b.waiting++;for(b=0;b<f;b++){e=d[b];if(!e)throw Error("Empty module name in require.");
var g=e.split("#"),e=this._resolveModule(g[0]),g=g[1],h=c.slice(0),i=c.indexOf(e);h.push(e);if(-1!=i)throw h=h.slice(i).join(" -> "),Error('Circular Dependency on Module "'+e+'": '+h);this._loadModule(a,h,e,b,g)}};SpotifyApi.prototype.varargs=function(a,b,c){b||(b=0);if(Array.isArray(a[b])){if(a.length>b+1)throw Error("Ambiguous use of varargs");a=a[b];b=0}return b||c?Array.prototype.slice.call(a,b):a};
SpotifyApi.prototype.uris=function(a,b){for(var c=this.varargs(a,b),d=[],e=0,f=c.length;e<f;e++)d.push(c[e].uri);return d};SpotifyApi.prototype.bind=function(a,b,c){if(2<arguments.length){var d=Array.prototype.slice,e=Function.prototype.bind;if(e&&a.bind===e)return e.apply(a,d.call(arguments,1));var f=d.call(arguments,2);return function(){return a.apply(b,arguments.length?f.concat(d.call(arguments)):f)}}return function(){return a.apply(b,arguments)}};
SpotifyApi.prototype.inherit=function(a,b){var c=function(){};c.prototype=a._superClass=b.prototype;a.prototype=new c;return a.prototype.constructor=a};SpotifyApi.prototype._patchRequestOpen=function(){var a=XMLHttpRequest.prototype.open,b=document.createElement("a"),c=window.location;XMLHttpRequest.prototype.open=function(d,e){var f=a.apply(this,arguments);b.href=e;b.protocol==c.protocol&&b.hostname==c.hostname&&this.setRequestHeader("X-Spotify-Requested-With","XMLHttpRequest");return f}};
function require(a,b){return SpotifyApi.api._require("__main__",{callback:function(){},waiting:1/0},[],a,b)}String;String.prototype.decodeForText=function(){return this.toString()};String.prototype.decodeForHtml=function(){var a={"&":"&amp;","<":"&lt;",">":"&gt;"},b=function(b){return a[b]};return function(){return this.replace(/[&<>]/g,b)}}();String.prototype.decodeForLink=function(){return encodeURI(this)};SpotifyApi.Bases={uri:"spotify",url:"http://open.spotify.com"};
SpotifyApi.Exps={spotify:/^spotify:(.+)$/,http:/^https?:\/\/open\.spotify\.com\/(.+)$/};String.prototype.toSpotifyURL=function(){var a=this.match(SpotifyApi.Exps.spotify);if(!a)return this;var a=a.pop().replace(/:$/,"").split(/:/),b=a.shift();"search"==b&&(a=[a.join(":")]);a.unshift(SpotifyApi.Bases.url,b);return a.join("/")};String.prototype.toSpotifyURI=function(){var a=this.match(SpotifyApi.Exps.http);if(!a)return this;a=a.pop().replace(/\/$/,"").split(/\//);a.unshift(SpotifyApi.Bases.uri);return a.join(":")};
String.prototype.toSpotifyLink=function(){return this.toSpotifyURI()};
