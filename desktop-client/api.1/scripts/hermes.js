require(["$api/models"],function(i){function j(a){return a.schema.id+"#"+a.name}function h(){}function e(a,c,f,k,b){d.call(this);this.resolve("uri",c);this.resolve("method",a);this.resolve("timeout",b||0);this._rtypes=f;this._atypes=k;a=g.join(this._rtypes.map(function(a){return a.schema.load("id")}));c=g.join(this._atypes.map(function(a){return a.schema.load("id")}));this._load=g.join(a,c)}function b(a){d.call(this);this._urls=a}var d=i.Loadable,g=i.Promise;h.get=function(a,c,f,b){return new e("GET",
a,c,f,b)};h.request=function(a,c,f,b,d){return new e(a,c,f,b,d)};SP.inherit(e,d);d.define(e,["uri","method","timeout"]);e.prototype.send=function(a){var c=new g,b=this,d=[].slice.call(arguments);this._load.done(function(){var a=b._rtypes.map(j),e=b._atypes.map(j);SP.request("hermes_send_request",[b.uri,b.method,a,e,d,b.timeout],c,function(a){c.setDone(a.result)},c.setFail)}).fail(function(a,b){c.setFail(b)});return c};SP.inherit(b,d);d.define(b,["id"],"_register");b.fromURL=function(a){"string"===
typeof a&&(a=[a]);return new this(a)};b.prototype.type=function(a){return{schema:this,name:a}};b.prototype._register=function(a){SP.request("hermes_register_schema",this._urls,this,function(b){this.resolveMany(a,b)},function(b){this.resolveFail(a,b)})};exports.Hermes=h;exports.Schema=b});
