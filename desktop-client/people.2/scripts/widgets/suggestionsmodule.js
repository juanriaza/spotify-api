require(["$api/models","$shared/events#EventHandler","$views/utils/css","scripts/widgets/suggestiongrid#SuggestionGrid","strings/people.lang"],function(h,j,f,k,i){function g(b,a,e,d,c){h.Observable.call(this);this.source=b;this.numSuggestions=a;this.sectionId=e;this.title=d;this.emptyText=c;this._eventHandler=new j(this)}var l=SP.bind(i.get,i);SP.inherit(g,h.Observable);g.prototype.dispose=function(){this._node&&(this._eventHandler.removeAll(),this._suggestions.dispose(),this._node.parentNode&&this._node.parentNode.removeChild(this._node),
delete this._eventHandler,delete this._suggestions,delete this._node)};g.prototype.getNode=function(){if(this._node)return this._node;var b=document.createElement("section");b.className="loading suggestions";b.id=this.sectionId;var a=new k(this.source,this.numSuggestions),e=document.createElement("h1");e.className="header";b.appendChild(e);var d=document.createElement("span");d.className="container";d.textContent=this.title;e.appendChild(d);var c=document.createElement("a");c.className="refresh";
c.textContent=l("Refresh");e=document.createElement("span");e.className="icon";c.appendChild(e);d.appendChild(c);this._eventHandler.listen(c,"click",function(){!f.hasClass(c,"clicked")&&this.dispatchEvent("refresh")&&(f.addClass(c,"clicked"),a.refresh(),setTimeout(function(){f.removeClass(c,"clicked")},600))}).listen(a,"subscribe",this.dispatchEvent).listen(a,"dismiss",this.dispatchEvent).listen(a,"navigate",this.dispatchEvent).listen(a,"sourcechange",function(){c.style.visibility=a.moreAvailable()?
"visible":"hidden";f.removeClass(b,"loading")}).listen(a,"displaycountchange",function(a){a.displayCount?f.removeClass(b,"empty"):f.addClass(b,"empty")});b.appendChild(a.getNode());d=document.createElement("p");d.className="empty container";d.textContent=this.emptyText;b.appendChild(d);this._suggestions=a;return this._node=b};exports.SuggestionsModule=g});
