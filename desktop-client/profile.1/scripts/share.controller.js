require("scripts/profile-utils scripts/controller#Controller $views/buttons $views/popup#Popup $views/utils/dom $views/utils/css scripts/share.search#Search $api/models $api/messaging strings/share.lang".split(" "),function(a,f,g,j,h,d,k,m,l,i){var e=SP.bind(i.get,i),a=function(){this.init()};SP.inherit(a,f);a.prototype.initialize=function(a,b,c){this.templates=c;this.user=b;this.container=document.querySelector(".app-share");this.render()};a.prototype.render=function(){this.container.innerHTML=this.templates.send_popup({content:this.templates.send_form({inputPlaceholder:e("searchFor"),
textareaPlaceholder:e("optionalMessage")})+this.templates.send_done({sentMessage:e("sent")})});var a=this.container.querySelector(".button-section"),b=g.Button.withLabel(e("cancel")),c=g.Button.withLabel(e("send"));d.addClass(c.node,"send-button");c.setDisabled(!0);c.setAccentuated(!0);h.addEventListener(b,"click",this.cancelButtonClicked.bind(this));h.addEventListener(c,"click",this.sendButtonClicked.bind(this));a.appendChild(c.node);a.appendChild(b.node);this.popup=j.withContent(this.container.querySelector(".share-content"),
350,140,"share-popup");this.search=new k(this.container.querySelector(".form-section"),this.templates,c);this.search.setEscapeClose(function(){this.popup.hide()}.bind(this))};a.prototype.show=function(a){this.container&&"object"===typeof this.container&&this.popup.showFor(a)};a.prototype.cancelButtonClicked=function(){this.popup.hide()};a.prototype.sendButtonClicked=function(){void 0!==this.search.getSelection()&&(d.addClass(this.popup.content,"sending"),l.send([this.user],this.search.getMessage(),
this.search.getSelection()),this.onMusicSent())};a.prototype.onMusicSent=function(){var a=this.popup,b=this;this.search.reset();d.removeClass(a.content,"sending");d.addClass(a.content,"sent");a.resize(73,25);setTimeout(function(){d.removeClass(b.popup.content,"sent");b.popup.resize(350,150);b.popup.hide()},2E3)};a.prototype.destroy=function(){this.popup.hide();f.prototype.destroy.call(this)};exports.Share=a});
